# MLPCG


This repository is based on the paper,[Our paper].
We accelate of fluid simulations by embedding a neural network in an existing solver for pressure, replacing an expensive pressure projection linked to a Poisson equation on the pressure, which is usually solved with iterative methods (CG or Jacobi methods). 
We implemented our code with TensorFLow(keras) for training parts.
We also have C++/CUDA implementation version.


## Requirements
* Python 3.8
* keras 2.8.0
* tensorflow 2.3.0

We are using vertual environment using conda.


## Training
### Dataset
We placed dataset here [place of the folder].Here, we generated this dataset by calculating ritz vecort, so we also show our code here. [GeneratingData.py]


### Training model
We placed already trained model here ```/trainedmodel```. Here, we also placed the training code.

```
cd ThisDir/src
python train_N64.py [epoch number] [epoch number for saved model] [batch size] [loading data size for once] [gpu usage memory 1024*int] [GPU id]
```



## Running test
The test data is under ```/test``` folder.The place of the folder is shown as below.
* RHS_.bin --> rhs
* A_.bin --> system matrix data, they strored by csr format.
* x_.bin --> generated by running test, the answer of Ax = b 


```
.
└── HomeDir(cloned Dir)
    ├── src
    └── dataset
        ├── test
        └── train
            └── trainedmodel

```

## Installation

1. Clone this repo:
```
it clone https://github.com/
```

2. Create and activate a conda environement
```
conda create --name venvname[name of vertual env] python=3.8
conda activate venvname
```

3. Install keras,tensorflow with cuda_11.7 and  the rest of necessary packages from the requirements file.
To install the rest of the packages running these command.
```
pip install -r requirements.txt
```


